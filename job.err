
Inactive Modules:
  1) CUDA/11.6.0                     8) binutils/2.37-GCCcore-11.2.0
  2) GCCcore/11.2.0                  9) bzip2/1.0.8-GCCcore-11.2.0
  3) GMP/6.2.1-GCCcore-11.2.0       10) libffi/3.4.2-GCCcore-11.2.0
  4) Python/3.9.6-GCCcore-11.2.0    11) libreadline/8.1-GCCcore-11.2.0
  5) SQLite/3.36-GCCcore-11.2.0     12) ncurses/6.2-GCCcore-11.2.0
  6) Tcl/8.6.11-GCCcore-11.2.0      13) zlib/1.2.11-GCCcore-11.2.0
  7) XZ/5.2.5-GCCcore-11.2.0

Due to MODULEPATH changes, the following have been reloaded:
  1) OpenSSL/1.1

The following have been reloaded with a version change:
  1) releases/2021b => releases/2023b


Activating Modules:
  1) GCCcore/13.2.0                   7) bzip2/1.0.8-GCCcore-13.2.0
  2) Python/3.11.5-GCCcore-13.2.0     8) libffi/3.4.4-GCCcore-13.2.0
  3) SQLite/3.43.1-GCCcore-13.2.0     9) libreadline/8.2-GCCcore-13.2.0
  4) Tcl/8.6.13-GCCcore-13.2.0       10) ncurses/6.4-GCCcore-13.2.0
  5) XZ/5.4.4-GCCcore-13.2.0         11) zlib/1.2.13-GCCcore-13.2.0
  6) binutils/2.40-GCCcore-13.2.0


Activating Modules:
  1) CUDA/12.5.0


[notice] A new release of pip is available: 23.2.1 -> 25.3
[notice] To update, run: pip install --upgrade pip
wandb: Tracking run with wandb version 0.23.1
wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Run data is saved locally in /auto/home/users/d/a/darimez/MIRO/vllmcluster/wandb/offline-run-20251230_140524-7x4mp203
[INFO] Computing embeddings from scratch...
[INFO] Added 5000 new embeddings. Total: 5000
[INFO] Computing distances for 5000 samples (79 x 79 blocks)...
[INFO] Distance computation complete
[INFO] Computing embeddings from scratch...
Traceback (most recent call last):
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/main.py", line 156, in <module>
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/main.py", line 116, in main
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/main.py", line 79, in cluster
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/amp/autocast_mode.py", line 44, in decorate_autocast
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/clustering.py", line 526, in distance_matrix_db
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/clustering.py", line 309, in forward
    self.logger.info(f"Found {existing_count} existing embeddings ...")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/clustering.py", line 116, in compute_losses
    correct += 1
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/ultralytics/nn/tasks.py", line 136, in forward
    return self.loss(x, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/ultralytics/nn/tasks.py", line 328, in loss
    return self.criterion(preds, batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/ultralytics/utils/loss.py", line 350, in __call__
    _, target_bboxes, target_scores, fg_mask, target_gt_idx = self.assigner(
                                                              ^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/ultralytics/utils/tal.py", line 79, in forward
    return self._forward(pd_scores, pd_bboxes, anc_points, gt_labels, gt_bboxes, mask_gt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/ultralytics/utils/tal.py", line 109, in _forward
    target_gt_idx, fg_mask, mask_pos = self.select_highest_overlaps(mask_pos, overlaps, self.n_max_boxes)
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/ultralytics/utils/tal.py", line 303, in select_highest_overlaps
    fg_mask = mask_pos.sum(-2)
              ^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 933394) is killed by signal: Killed. 
slurmstepd: error: Detected 1 oom_kill event in StepId=66733646.batch. Some of the step tasks have been OOM Killed.
