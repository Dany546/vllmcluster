
Inactive Modules:
  1) CUDA/11.6.0                     8) binutils/2.37-GCCcore-11.2.0
  2) GCCcore/11.2.0                  9) bzip2/1.0.8-GCCcore-11.2.0
  3) GMP/6.2.1-GCCcore-11.2.0       10) libffi/3.4.2-GCCcore-11.2.0
  4) Python/3.9.6-GCCcore-11.2.0    11) libreadline/8.1-GCCcore-11.2.0
  5) SQLite/3.36-GCCcore-11.2.0     12) ncurses/6.2-GCCcore-11.2.0
  6) Tcl/8.6.11-GCCcore-11.2.0      13) zlib/1.2.11-GCCcore-11.2.0
  7) XZ/5.2.5-GCCcore-11.2.0

Due to MODULEPATH changes, the following have been reloaded:
  1) OpenSSL/1.1

The following have been reloaded with a version change:
  1) releases/2021b => releases/2023b


Activating Modules:
  1) GCCcore/13.2.0                   7) bzip2/1.0.8-GCCcore-13.2.0
  2) Python/3.11.5-GCCcore-13.2.0     8) libffi/3.4.4-GCCcore-13.2.0
  3) SQLite/3.43.1-GCCcore-13.2.0     9) libreadline/8.2-GCCcore-13.2.0
  4) Tcl/8.6.13-GCCcore-13.2.0       10) ncurses/6.4-GCCcore-13.2.0
  5) XZ/5.4.4-GCCcore-13.2.0         11) zlib/1.2.13-GCCcore-13.2.0
  6) binutils/2.40-GCCcore-13.2.0


Activating Modules:
  1) CUDA/12.5.0

wandb: Currently logged in as: dany404 to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.23.1
wandb: Run data is saved locally in /auto/home/users/d/a/darimez/MIRO/vllmcluster/wandb/run-20251229_154349-8kp0q0tu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run revived-energy-434
wandb: ‚≠êÔ∏è View project at https://wandb.ai/miro-unet/VLLM%20clustering
wandb: üöÄ View run at https://wandb.ai/miro-unet/VLLM%20clustering/runs/8kp0q0tu
[INFO] Computing embeddings from scratch...
Traceback (most recent call last):
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/main.py", line 155, in <module>
    main(args)
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/main.py", line 115, in main
    cluster(args)
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/main.py", line 78, in cluster
    clustering_layer.distance_matrix_db(dataloader)
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/amp/autocast_mode.py", line 44, in decorate_autocast
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/clustering.py", line 319, in distance_matrix_db
    emb = self.model(images)
          ^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/dino/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/model.py", line 125, in forward
    return self.attention_pooling_fn(image)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/auto/home/users/d/a/darimez/MIRO/vllmcluster/model.py", line 110, in attention_pooling_fn
    cls_attn = attn[:, :, 0, 1:] # (B, H, N)
              ~~~~^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable
